<view class="container">
  <!-- èŠå¤©å¤´éƒ¨ -->
  <view class="chat-header">
    <view class="room-title">{{roomName}}</view>
    <view class="participant-count">{{participants.length}} ä¸ª AI åˆ†èº«è®¨è®ºä¸­</view>
  </view>

  <!-- æ¶ˆæ¯åˆ—è¡¨ -->
  <scroll-view 
    class="message-list" 
    scroll-y="{{true}}" 
    scroll-into-view="{{scrollToId}}"
    enhanced="{{true}}"
    show-scrollbar="{{false}}"
  >
    <view class="system-msg">
      <text class="system-text">ğŸ¤– AI åˆ†èº«å·²å°±ä½ï¼Œå¼€å§‹è®¨è®ºåƒä»€ä¹ˆ</text>
    </view>
    
    <block wx:for="{{messages}}" wx:key="id">
      <view 
        id="msg-{{item.id}}"
        class="message {{item.isSelf ? 'message-self' : 'message-other'}}"
        style="animation-delay: {{index * 0.1}}s"
      >
        <view class="avatar-wrapper">
          <view class="avatar" style="background: {{item.color}}">
            {{item.userName[0]}}
          </view>
          <text class="avatar-name">{{item.avatarName}}</text>
        </view>
        
        <view class="message-content">
          <view class="message-bubble">
            <text class="message-text">{{item.content}}</text>
          </view>
          <view class="message-tag" style="background: {{item.tagColor}}">
            {{item.typeText}}
          </view>
        </view>
      </view>
    </block>
    
    <!-- æ­£åœ¨è¾“å…¥ -->
    <view wx:if="{{typing}}" class="typing">
      <view class="typing-dot"></view>
      <view class="typing-dot"></view>
      <view class="typing-dot"></view>
    </view>
    
    <view id="bottom"></view>
  </scroll-view>

  <!-- æ¨èç»“æœ -->
  <view wx:if="{{showResult}}" class="result-card">
    <view class="result-header">
      <text class="result-icon">ğŸ‰</text>
      <text class="result-title">AI åˆ†èº«è¾¾æˆå…±è¯†ï¼</text>
    </view>
    
    <view class="restaurant-info">
      <view class="restaurant-header">
        <view>
          <text class="restaurant-name">{{restaurant.name}}</text>
          <view class="restaurant-meta">
            <text class="cuisine-tag">{{restaurant.cuisine}}</text>
            <text class="rating">â­ {{restaurant.rating}}</text>
            <text class="cost">äººå‡ Â¥{{restaurant.cost}}</text>
          </view>
        </view>
      </view>
      
      <view class="info-row">
        <text class="info-icon">ğŸ“</text>
        <text class="info-text">{{restaurant.address}}</text>
      </view>
      
      <view class="info-row" wx:if="{{restaurant.tel}}">
        <text class="info-icon">ğŸ“</text>
        <text class="info-text">{{restaurant.tel}}</text>
      </view>
      
      <view class="dishes-section">
        <text class="dishes-title">ğŸ½ï¸ æ¨èèœå“</text>
        <view class="dishes-list">
          <text wx:for="{{restaurant.dishes}}" wx:key="index" class="dish-tag">
            {{item}}
          </text>
        </view>
      </view>
      
      <button class="nav-btn" bindtap="openMap">
        <text>ğŸ—ºï¸</text>
        <text>é«˜å¾·åœ°å›¾å¯¼èˆª</text>
      </button>
    </view>
    
    <view class="result-footer">
      <text>ğŸ¤– ç”± AI åˆ†èº«æ™ºèƒ½åˆ†ææ¨è</text>
    </view>
  </view>

  <!-- åº•éƒ¨å ä½ -->
  <view wx:if="{{!showResult}}" class="bottom-placeholder"></view>
</view>
